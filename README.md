# 2023 국립안동대학교 해커톤
## [아두이노 코드](https://github.com/BAIKJUWON/AnuHackerton/blob/main/Hackerton.ino)
## [발표자료](https://github.com/BAIKJUWON/AnuHackerton/blob/main/%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%E1%84%8C%E1%85%A1%E1%84%85%E1%85%AD/Hackerton.pdf)

# ESP32를 사용한 스마트 홈 시스템

이 프로젝트는 ESP32 마이크로컨트롤러를 사용하여 개발된 스마트 홈 시스템입니다. 이 시스템은 LED, 블라인드 및 도어 제어용 서보 모터, 온도 센서, IR 센서, 부저 등의 다양한 구성 요소와 라이브러리를 활용합니다. 또한, ESP32는 웹 서버 역할을 하여 사용자가 웹 인터페이스를 통해 이러한 장치를 제어할 수 있도록 합니다.

## 주요 구성 요소 및 라이브러리

1. **ESP32Servo 라이브러리**: 블라인드와 도어용 서보 모터를 제어하는 데 사용됩니다.
2. **OneWire 및 DallasTemperature 라이브러리**: 온도 센서와 인터페이스하기 위해 사용됩니다.
3. **WiFi 라이브러리**: WiFi 연결을 관리하고 ESP32를 액세스 포인트(AP)로 구성합니다.
4. **WebServer 라이브러리**: ESP32가 웹 인터페이스를 제공하여 스마트 홈 장치를 원격으로 제어할 수 있도록 합니다.
5. **Adafruit_NeoPixel 라이브러리**: RGB LED를 제어하여 색상 변경 및 밝기 조절을 가능하게 합니다.

## 시스템 구성

- **WiFi 구성**: ESP32는 AP 모드로 설정되며, SSID와 비밀번호가 정의됩니다. IP, 게이트웨이, 서브넷 구성도 설정됩니다.
  
- **웹 서버**: 서버는 포트 80에서 초기화되며, 다양한 작업(예: LED 켜기/끄기, 블라인드 제어 등)을 처리하기 위해 여러 엔드포인트가 정의됩니다.

- **GPIO 핀 구성**: 여러 GPIO 핀은 LED, 서보 모터, IR 센서, 부저와 인터페이스하기 위해 설정됩니다.

## 하드웨어 구성 요소

- **LED**: 네 개의 LED가 ESP32에 연결되어 있으며, PWM을 통해 밝기를 조절합니다.
  
- **서보 모터**: 두 개의 서보 모터가 블라인드와 도어를 제어합니다. 블라인드 모터는 조도 센서의 읽기값에 따라 조정되며, 도어 모터는 수동으로 또는 IR 센서에 따라 자동으로 제어할 수 있습니다.
  
- **온도 센서**: 주변 온도를 읽고 이를 웹 인터페이스에 표시합니다.
  
- **IR 센서**: 모션 또는 근접성을 감지하여 자동 도어 제어에 사용됩니다.
  
- **부저**: 특정 조건이 충족되었을 때 경고음을 제공합니다.

## 기능 개요

1. **LED 제어**: 시스템은 PWM 신호를 사용하여 여러 LED의 밝기를 제어할 수 있습니다. 웹 인터페이스를 통해 다양한 밝기 수준(0%, 33%, 66%, 100%)을 조절할 수 있는 엔드포인트가 제공됩니다.

2. **RGB LED 제어**: Adafruit NeoPixel 라이브러리를 사용하여 RGB LED의 색상과 밝기를 변경할 수 있습니다. 사용자는 웹 인터페이스를 통해 다양한 색상을 선택할 수 있습니다.

3. **블라인드 제어**: 서보 모터를 사용하여 블라인드를 열거나 닫을 수 있습니다. 블라인드의 위치는 조도 센서 읽기값에 따라 자동으로 조정될 수도 있습니다.

4. **도어 제어**: 서보 모터를 사용하여 도어를 열거나 닫을 수 있습니다. 또한, 도어를 자동 모드로 설정하여 IR 센서 읽기값에 따라 자동으로 열리거나 닫히게 할 수 있습니다.

5. **온도 표시**: 현재 온도가 센서에서 읽혀져 웹 인터페이스에 표시됩니다.

6. **웹 인터페이스**: 모든 스마트 홈 기능을 원격으로 제어할 수 있는 사용자 친화적인 HTML 인터페이스가 제공됩니다.

7. **보안 기능**: IR 센서와 부저를 사용하여 문 근처의 무단 접근 또는 움직임을 감지합니다.

## 주요 함수 및 설명

- **`setup()`**: 직렬 통신, WiFi, 웹 서버, 센서 및 하드웨어 구성 요소를 초기화합니다. 핀 모드를 구성하고 필요한 서비스를 시작합니다.
  
- **`loop()`**: 웹 서버 요청을 처리하고 센서 읽기값 및 사용자 입력에 따라 작업을 수행하는 주요 논리를 포함합니다.

- **`handle_root()`**: 스마트 홈 시스템의 현재 상태와 제어 버튼을 표시하는 HTML 페이지를 제공합니다.

- **`led_on(int duty)`**: PWM 신호를 사용하여 LED의 밝기를 제어합니다.

- **`servo_light_on()`**: 조도 센서 읽기값에 따라 블라인드 서보 모터를 조정합니다.

- **`handle_*` 함수들**: LED 켜기/끄기, 블라인드 열기/닫기, 도어 제어와 같은 다양한 작업에 대한 HTTP GET 요청을 처리하는 일련의 함수들입니다.

## 웹 인터페이스 기능

- 웹 인터페이스에는 RGB LED, 일반 LED, 블라인드, 도어 작동을 제어하기 위한 여러 세트의 버튼이 포함되어 있습니다.
  
- JavaScript 함수를 사용하여 페이지를 새로고침하지 않고도 ESP32 서버 엔드포인트에 AJAX 호출을 수행할 수 있습니다.

## 시스템 워크플로우

1. **초기화**: 시작 시, 시스템은 모든 센서를 초기화하고, WiFi 액세스 포인트를 설정하며, 웹 서버를 시작합니다.
  
2. **사용자 상호작용**: 사용자는 웹 인터페이스를 통해 시스템과 상호작용하며 ESP32 서버로 명령을 보냅니다.

3. **장치 제어**: 수신된 명령과 센서 데이터를 기반으로 ESP32는 연결된 장치(LED, 서보 모터 등)를 제어합니다.

4. **피드백**: 시스템은 현재 상태와 센서 데이터에 따라 웹 인터페이스에 시각적 피드백을 제공하고, 부저를 통해 청각적 피드백을 제공합니다.

## 향후 개선 사항

- 이메일 또는 SMS를 통한 실시간 알림과 같은 추가 보안 기능 구현.
- 더 많은 가정 자동화 기능을 통합하여 제어 가능한 장치의 범위를 확장.
- WebSockets 또는 MQTT를 사용하여 실시간 업데이트를 통해 웹 인터페이스를 개선하여 더 빠른 응답 시간 제공.

이 스마트 홈 시스템은 ESP32의 기능을 활용하여 유연하고 사용자 친화적인 제어 환경을 만드는 가정 자동화의 강력한 기반을 제공합니다.

